// Generated by CoffeeScript 1.4.0
(function() {
  var GameController;

  chrome.app.Controllers.Game = GameController = (function() {

    function GameController(character) {
      var packet;
      this.character = character;
      packet = new chrome.app.Packets.SelectCharacter(this.character);
      packet.bufferize(Lineage.socket.send);
    }

    GameController.prototype.render = function() {
      $(document.body).empty();
      $(document.body).append("      <div id='chatBox'>        <ul class='history'>        </ul>        <form>          <input type='text' placeholder='Send a message' />          <input type='submit'>        </form>        </div>");
      return this.eventify($(document.body));
    };

    GameController.prototype.eventify = function($html) {
      return $html.on("submit", "form", function(e) {
        var $input, message, packet;
        $input = $(this).children("input").first();
        message = $input.val();
        $input.val("");
        packet = new chrome.app.Packets.Chat(message, true);
        packet.bufferize(Lineage.socket.send);
        return false;
      });
    };

    GameController.prototype.received = function(packet) {
      var $li;
      switch (packet.id) {
        case PacketId.Chat:
        case PacketId.GlobalChat:
        case PacketId.WhisperChat:
          $li = $("<li>" + (packet.message()) + "</li>");
          $li.addClass(packet.type);
          $(document.body).find("ul.history").append($li);
      }
      return console.log(packet);
    };

    return GameController;

  })();

}).call(this);
